<h1><%= @project %></h1>

<h2>Builds</h2>

<%= form_tag(project_path(@project), method: :get) do %>
  <%= select_tag "branch_name", options_for_select(@branch_names), prompt: "Select a branch" %>
  <%= submit_tag "Apply" %>
<% end %>

<% if @builds.any? %>
  <table border>
    <tr>
      <th>Start</th>
      <th>Branch</th>
      <th>Author</th>
      <th>Commit</th>
      <th>Commit Message</th>
      <th>Status</th>
      <th>Duration</th>
      <th>Actions</th>
    </tr>

    <% @builds.each do |build| %>
      <tr>
        <td><%= link_to build.created_at, build %></td>
        <td><%= build.branch_name %></td>
        <td><%= build.author_name %></td>
        <td><code><%= build.commit_hash[0..7] %></code></td>
        <td><%= build.commit_message.truncate(50) %></td>
        <td><%= build.status %></td>
        <td><%= build.duration_formatted %></td>
        <td>
          <%= button_to "Rerun", rebuilds_path(build_id: build.id), method: :post %>
        </td>
      </tr>
    <% end %>
  </table>
<% else %>
  (No builds)
<% end %>
